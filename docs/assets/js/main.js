"use strict";const showsPainted=document.querySelector(".js_showlistcontainer"),searchBtn=document.querySelector(".js_searchbtn"),searchText=document.querySelector(".js_searchtext"),favoriteShowsPainted=document.querySelector(".js_favoriteshowscontainer"),favoritesResetBtn=document.querySelector(".js_resetfavsbtn");let showsList=[],showsImages=[],showsTitles=[],showsId=[],listenedItem=[],favoriteShows=[],favoriteShowsImages=[],favoriteShowsTitles=[],favoritesShowsId=[],favoriteSelectedShows=[];function paintFavorites(){let e="";for(const t of favoriteShows)favoriteShowsImages=t.show.image,favoriteShowsImages=null===favoriteShowsImages?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":t.show.image.medium,favoriteShowsTitles=t.show.name,favoritesShowsId=t.show.id,e+=`<li class="favorite_container"   id="${favoritesShowsId}">`,e+=`<img class="favorite_image" src="${favoriteShowsImages}" alt="${favoriteShowsTitles}"/>`,e+=`<h2 class="favorite_title">${favoriteShowsTitles}</h2>`,e+='<button class="favorite__delbtn js_favoritedelbtn"><i class="fas fa-times favorite__delbtn--icon"></i></button>',e+="</li>";favoriteShowsPainted.innerHTML=e;const t=document.querySelectorAll(".favorite__delbtn");for(const e of t)e.addEventListener("click",handleDelFavBtn)}function handleListenedContainers(e){const t=e.currentTarget,s=t.querySelector(".js_showtitle"),o=parseInt(e.currentTarget.id),a=showsList.find(e=>e.show.id===o),i=favoriteShows.findIndex(e=>e.show.id===o);-1===i?(favoriteShows.push(a),t.classList.add("selected"),s.classList.add("text_color")):(favoriteShows.splice(i,1),t.classList.remove("selected"),s.classList.remove("text_color")),saveSelectedShowsLocalStorage(),paintFavorites(),saveFavoritesInLocalStorage()}function saveSelectedShowsLocalStorage(){const e=JSON.stringify(favoriteShows);localStorage.setItem("favoriteSelectedShows",e)}function saveFavoritesInLocalStorage(){const e=JSON.stringify(favoriteShows);localStorage.setItem("favoriteShows",e)}function listenShows(){const e=document.querySelectorAll(".js_showcontainer");for(listenedItem of e)listenedItem.addEventListener("click",handleListenedContainers)}function paintShows(){let e="";for(const t of showsList)showsImages=t.show.image,showsImages=null===showsImages?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":t.show.image.medium,showsTitles=t.show.name,showsId=t.show.id,favoriteSelectedShows.includes(t)?e+=`<li class="show_container js_showcontainer selected"  id="${showsId}">`:e+=`<li class="show_container js_showcontainer"  id="${showsId}">`,e+=`<img class="image js_showimage" src="${showsImages}" alt="${showsTitles}"/>`,favoriteSelectedShows.includes(t)?e+=`<h4 class="showtitle js_showtitle text_color">${showsTitles}</h4>`:e+=`<h4 class="showtitle js_showtitle">${showsTitles}</h4>`,e+="</li>";showsPainted.innerHTML=e,listenShows()}function handleSearchShow(e){e.preventDefault();const t=searchText.value;fetch("//api.tvmaze.com/search/shows?q="+t).then(e=>e.json()).then(e=>{showsList=e,paintShows()})}function getFavoritesSelectedShowsFromLocalSt(){const e=localStorage.getItem("favoriteSelectedShows");if(null!==e){const t=JSON.parse(e);favoriteSelectedShows=t,paintFavorites()}}function getFavoritesFromLocalStorage(){const e=localStorage.getItem("favoriteShows");if(null!==e){const t=JSON.parse(e);favoriteShows=t,paintFavorites()}}function handleDelFavBtn(e){const t=e.currentTarget.parentElement.id,s=favoriteShows.findIndex(e=>e.show.id===parseInt(t));favoriteShows.splice(s,1),favoriteSelectedShows.splice(s,1);const o=document.querySelectorAll(".selected");for(const e of o)e&&e.classList.remove("selected");const a=document.querySelectorAll(".text_color");for(const e of a)e&&e.classList.remove("text_color");saveFavoritesInLocalStorage(),saveSelectedShowsLocalStorage(),paintFavorites()}function handleFavoritesResetBtn(){const e=favoriteShows.length;favoriteShows.splice(0,e),localStorage.removeItem("favoriteShows"),localStorage.removeItem("favoriteSelectedShows"),paintFavorites()}searchBtn.addEventListener("click",handleSearchShow),getFavoritesSelectedShowsFromLocalSt(),getFavoritesFromLocalStorage(),favoritesResetBtn.addEventListener("click",handleFavoritesResetBtn);