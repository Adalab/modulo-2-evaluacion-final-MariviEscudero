"use strict";const showsPainted=document.querySelector(".js_showlistcontainer"),searchBtn=document.querySelector(".js_searchbtn"),searchText=document.querySelector(".js_searchtext"),favoriteShowsPainted=document.querySelector(".js_favoriteshowscontainer"),favoritesResetBtn=document.querySelector(".js_resetfavsbtn");let showsList=[],favoriteShows=[];function paintFavorites(){let e="";for(const t of favoriteShows)e+=`<li class="main__favorites--showlist"   id="${t.id}">`,e+=`<img class="main__favorites--showlist__image" src="${t.showImage}" alt="${t.name}"/>`,e+=`<h2 class="main__favorites--showlist__showtitle">${t.name}</h2>`,e+='<button class="main__favorites--showlist__delbtn js_favoritedelbtn"><i class="fas fa-times-circle"></i></button>',e+="</li>";favoriteShowsPainted.innerHTML=e;const t=document.querySelectorAll(".js_favoritedelbtn");for(const e of t)e.addEventListener("click",handleDelFavBtn)}function handleListenedContainers(e){e.preventDefault();const t=parseInt(e.currentTarget.id),o=showsList.find(e=>e.id===t),s=favoriteShows.findIndex(e=>e.id===t);-1===s?favoriteShows.push(o):favoriteShows.splice(s,1),paintFavorites(),paintShows(),saveFavoritesInLocalStorage()}function saveFavoritesInLocalStorage(){const e=JSON.stringify(favoriteShows);localStorage.setItem("favoriteShows",e)}function listenShows(){const e=document.querySelectorAll(".js_showcontainer");for(const t of e)t.addEventListener("click",handleListenedContainers)}function isFavorite(e){return void 0!==favoriteShows.find(t=>t.id===e.id)}function paintShows(){let e="",t="",o="";for(const s of showsList){isFavorite(s)?(t="selected",o="text_color"):(t="",o=""),e+=`<li class="main__showlist--item js_showcontainer ${t}"  id="${s.id}">`,e+=`<img class="main__showlist--item__image js_showimage" src="${s.showImage}" alt="${s.name}"/>`,e+=`<h4 class="main__showlist--item__showtitle js_showtitle ${o}">${s.name}</h4>`,e+="</li>"}showsPainted.innerHTML=e,listenShows()}function handleSearchShow(e){e.preventDefault();const t=searchText.value;fetch("//api.tvmaze.com/search/shows?q="+t).then(e=>e.json()).then(e=>{showsList=e.map(e=>({id:e.show.id,name:e.show.name,showImage:null!==e.show.image?e.show.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text=TV"})),paintShows()})}function getFavoritesFromLocalStorage(){const e=localStorage.getItem("favoriteShows");if(null!==e){const t=JSON.parse(e);favoriteShows=t,paintFavorites()}}function handleDelFavBtn(e){const t=e.currentTarget.parentElement.id,o=favoriteShows.findIndex(e=>e.id===parseInt(t));favoriteShows.splice(o,1),saveFavoritesInLocalStorage(),paintFavorites(),paintShows()}function handleFavoritesResetBtn(){const e=favoriteShows.length;favoriteShows.splice(0,e),localStorage.removeItem("favoriteShows"),localStorage.removeItem("favoriteSelectedShows"),paintFavorites(),paintShows()}searchBtn.addEventListener("click",handleSearchShow),getFavoritesFromLocalStorage(),favoritesResetBtn.addEventListener("click",handleFavoritesResetBtn);